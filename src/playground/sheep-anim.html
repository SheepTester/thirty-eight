<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Sheep animation</title>
    <meta name="description" content="Sheep"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" type="text/css" href="/sheep3.css">
    <script src="/sheep3.js" charset="utf-8"></script>
    <style media="screen">
      @import url('../css/basic.css');
      @import url('../css/canvas.css');

      canvas {
        image-rendering: crisp-edges;
        image-rendering: pixelated;
      }
    </style>
  </head>
  <body>
    <script type="module">
import { CanvasWrapper, loadImage } from '../lib/canvas.js'
import { SpritesheetAnimation } from '../lib/spritesheet-animation.js'
import { Resizer } from '../lib/resizer.js'
import { Animator } from '../lib/animator.js'
import { Simulator } from '../lib/simulator.js'

const canvas = new CanvasWrapper().addTo(document.body)

const resizer = new Resizer([canvas]).listen()

Promise.all([
  loadImage('../assets/sheep2.png'),
  loadImage('../assets/sheep3.png'),
  resizer.resize()
]).then(([sheep2, sheep3]) => {
  const sheep2Anim = new SpritesheetAnimation({ image: sheep2, frames: 2, fps: 6 })
  const sheep3Anim = new SpritesheetAnimation({ image: sheep3, frames: 3, fps: 6 })

  const simulator = new Simulator({ simulations: [sheep2Anim, sheep3Anim] })

  const animator = new Animator(() => {
    simulator.simulate()

    canvas.context.clearRect(0, 0, canvas.width, canvas.height)
    canvas.context.imageSmoothingEnabled = false

    sheep2Anim.draw({ canvas, x: 0, y: 0, width: sheep2Anim.width * 2, height: sheep2Anim.height * 2 })
    sheep3Anim.draw({ canvas, x: 150, y: 0, width: sheep3Anim.width * 2, height: sheep3Anim.height * 2 })
  }).start()
})
    </script>
  </body>
</html>
